# 方差分析 ANOVA

# 1、基本概念

## 1.1 定义及应用

从形式上看，方差分析师比较多个总体的均值是否相等，本质上是研究**分类型自变量**对**数值型因变量**的影响，与回归分析的方法有许多相同之处，但又有本质区别。在研究一个（或多个）分类型自变量与一个数值型因变量之间的关系时，方差分析就是其中的主要方法之一。

## 1.2 因子、水平

在方差分析中，所要检验的对象称为**因素**或**因子**（factor）。
 因素的不同表现称为**水平**或**处理**（treatment）。
 每个因子水平下得到的样本数据称为**观察值**。

## 1.3 误差分解

### 1.3.1 组内误差 SSE

- 来自水平内部的数据误差称为组内误差。

例如在上表中，零售业中抽取的7家企业之间的投诉次数是不同的，由于企业是随机抽取的，因此他们之间的差异可以看成是随机因素的影响造成的。

- 组内误差只含有**随机误差**。

### 1.3.2 组间误差 SSA

- 来自不同水平之间的数据误差称为组间误差。
- 这种差异可能是由抽样本身形成的随机误差，也可能是由行业本身的系统性误差造成的系统误差。组间误差是**随机误差**和**系统误差**的总和。

### 1.3.3 SST、SSE、SSA

- 1、反应全部数据误差大小的平方和称为**总平方和**，记为**SST**。
   试验中，23家企业被投诉次数之间的误差平方就是总平方和，反应全部观测值的离散状况。
   自由度为**n-1**，n为全部观测值的个数
- 2、反应组内误差大小的平方和称为**组内平方和**，也称为**误差平方**和或者**残差平方和**，记为**SSE**。
   试验中，每个样本内部的数据平方和加在一起就是组内平方和，反应每个样本内各观察值的离散情况。
   自由度为**n-k**，k为因素水平（总体）的个数
- 3、反应组间误差大小的平方和称为**组间平方和**，也称为**因素平方和**，记为**SSA**。
   试验中，四个行业被投诉次数之间的误差平方和就是组间平方和，反应了样本均值之间的差异程度。
   自由度为**k-1**

SST = SSE + SSA

### 1.3.4 MSA、MSE

MSA= 组间平方和/自由度 = SSA/（k-1）
MSE=组内平方和/自由度 = SSE/（n-k）

** 如果不同行业对被投诉次数没有影响，那么在组间误差中，值包含随机误差，而没有系统误差。这时，组间误差与组内误差经过平均后的数值（称为均方或方差）就应该很接近，他们的比值就会接近1。

** 反之，如果不同行业对被投诉次数有影响，在组间误差中除了包含随机误差，还会包含系统误差，这时组间误差平均后的数值就会大于组内误差平均后的数值，他们之间的比值就会大于1。

判断行业对被投诉次数是否有显著影响，实际上也就是检验被投诉次数的差异主要是由什么原因引起的，如果这种差异主要是系统误差，就认为不同行业对被投诉次数有显著影响，也就是检验四个行业被投诉次数的均值是否相等。

## 1.4 方差分析中的基本假定

### 1.4.1 每个总体都服从正态分布

对因素的每一水平，其观测值都是来自正态分布总体的简单随机样本。

### 1.4.2 各个总体的方差必须相同

每个行业被投诉次数的方差相同。

### 1.4.3 观测值是独立的

（资源来自网络）